<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Valentine's Air Hockey</title>
    <style>
        body {
            text-align: center;
            font-family: 'Courier New', monospace;
            background-color: pink;
            overflow: hidden;
        }
        h1 {
            font-size: 3rem;
            color: red;
        }
        canvas {
            background-color: white;
            border: 5px solid red;
            display: block;
            margin: auto;
        }
        .message {
            font-size: 1.5rem;
            color: darkred;
            margin-top: 20px;
        }
        .btn {
            font-size: 1.5rem;
            padding: 10px 20px;
            margin: 20px;
            border: none;
            cursor: pointer;
            border-radius: 10px;
            background-color: lightgreen;
            display: none;
        }
        .music-btn {
            font-size: 1.2rem;
            padding: 10px 15px;
            border: none;
            cursor: pointer;
            border-radius: 10px;
            background-color: lightcoral;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <h1>Score 3 Goals to Win! ‚ù§Ô∏è</h1>
    <p class="message" id="message">Move your paddle and hit the puck into the goal while avoiding the golie (I am the goalie hehe)</p>
    <button class="music-btn" onclick="playMusic()">Play Special Song üé∂</button>
    <audio id="background-music" loop>
        <source src="wavin.mp3" type="audio/mpeg">
    </audio>
    <canvas id="hockeyCanvas" width="600" height="400"></canvas>
    <a href ="helmi4.html"><button class="btn" id="nextButton" onclick="nextPage()">Proceed ‚û°Ô∏è</button></a>

    <script>
        function playMusic() {
            let audio = document.getElementById("background-music");
            audio.play().catch(error => console.log("Audio play failed: ", error));
        }

        const canvas = document.getElementById("hockeyCanvas");
        const ctx = canvas.getContext("2d");
        const nextButton = document.getElementById("nextButton");
        let playerScore = 0;
        let puck = { x: 300, y: 200, dx: 3, dy: 3, radius: 10 };
        let paddle = { x: 260, y: 370, width: 80, height: 10 };
        let goal = { x: 100, y: 5, width: 400, height: 10 };
        let aiPaddle = { x: 250, y: 20, width: 100, height: 10 };

        function resetPuck() {
            puck.x = 300;
            puck.y = 200;
            puck.dx = (Math.random() * 4 + 2) * (Math.random() < 0.5 ? 1 : -1);
            puck.dy = 3 * (Math.random() < 0.5 ? 1 : -1);
        }

        document.addEventListener("mousemove", event => {
            let rect = canvas.getBoundingClientRect();
            paddle.x = event.clientX - rect.left - paddle.width / 2;
        });

        function moveAiPaddle() {
            let reactionSpeed = 0.04;
            aiPaddle.x += (puck.x - aiPaddle.x - aiPaddle.width / 2) * reactionSpeed;
            aiPaddle.x = Math.max(0, Math.min(canvas.width - aiPaddle.width, aiPaddle.x));
        }

        function movePuck() {
            puck.x += puck.dx;
            puck.y += puck.dy;

            if (puck.x - puck.radius < 0 || puck.x + puck.radius > canvas.width) {
                puck.dx *= -1;
            }

            if (puck.y - puck.radius < 0) {
                resetPuck();
            }

            if (puck.y + puck.radius > canvas.height) {
                resetPuck();
            }

            if (
                puck.x > paddle.x && puck.x < paddle.x + paddle.width &&
                puck.y + puck.radius >= paddle.y
            ) {
                puck.dy *= -1;
                puck.y = paddle.y - puck.radius;
            }

            if (
                puck.x > aiPaddle.x && puck.x < aiPaddle.x + aiPaddle.width &&
                puck.y - puck.radius < aiPaddle.y + aiPaddle.height
            ) {
                puck.dy *= -1;
                puck.y = aiPaddle.y + aiPaddle.height + puck.radius;
            }

            if (
                puck.y - puck.radius < goal.y + goal.height &&
                puck.x > goal.x && puck.x < goal.x + goal.width
            ) {
                playerScore++;
                resetPuck();
                if (playerScore >= 3) {
                    document.getElementById("message").textContent = "You win! ‚ù§Ô∏è";
                    nextButton.style.display = "block";
                }
            }
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = 'red';
            ctx.fillRect(goal.x, goal.y, goal.width, goal.height);
            ctx.fillStyle = "blue";
            ctx.fillRect(paddle.x, paddle.y, paddle.width, paddle.height);
            ctx.fillStyle = "red";
            ctx.fillRect(aiPaddle.x, aiPaddle.y, aiPaddle.width, aiPaddle.height);
            ctx.beginPath();
            ctx.arc(puck.x, puck.y, puck.radius, 0, Math.PI * 2);
            ctx.fillStyle = "black";
            ctx.fill();
            ctx.closePath();
            movePuck();
            moveAiPaddle();
            requestAnimationFrame(draw);
        }

        function nextPage() {
            window.location.href = "final.html";
        }

        draw();
    </script>
</body>
</html>
